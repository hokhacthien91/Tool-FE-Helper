function getReportScript() {
  return `<script>\n    (function() {\n      function updateGroupState(group, content, toggleBtn) {\n        const collapsed = group.classList.contains('collapsed');\n        if (collapsed) {\n          content.style.display = 'none';\n          if (toggleBtn) toggleBtn.textContent = '+';\n        } else {\n          content.style.display = 'block';\n          if (toggleBtn) toggleBtn.textContent = 'âˆ’';\n        }\n      }\n      function initCollapsibles() {\n        document.querySelectorAll('.issue-group').forEach(group => {\n          const header = group.querySelector('.issue-group-header');\n          const content = group.querySelector('.issue-group-content');\n          const toggleBtn = group.querySelector('.issue-group-toggle');\n          if (!content || !header) return;\n          const toggle = () => {\n            group.classList.toggle('collapsed');\n            updateGroupState(group, content, toggleBtn);\n          };\n          if (toggleBtn) {\n            toggleBtn.addEventListener('click', e => {\n              e.stopPropagation();\n              toggle();\n            });\n          }\n          header.addEventListener('click', e => {\n            if (toggleBtn && (e.target === toggleBtn || toggleBtn.contains(e.target))) {\n              return;\n            }\n            toggle();\n          });\n          updateGroupState(group, content, toggleBtn);\n        });\n      }\n      function applySeverityFilter(filter) {\n        const buttons = document.querySelectorAll('.export-filter-btn');\n        buttons.forEach(btn => {\n          const val = btn.getAttribute('data-severity') || 'all';\n          btn.classList.toggle('active', val === filter);\n        });\n        document.querySelectorAll('.issue-group').forEach(group => {\n          const issues = group.querySelectorAll('.issue');\n          const label = group.getAttribute('data-label') || '';\n          let visibleCount = 0;\n          issues.forEach(issue => {\n            const isError = issue.classList.contains('error');\n            const isWarn = issue.classList.contains('warn');\n            let show = false;\n            if (filter === 'all') show = true;\n            else if (filter === 'error') show = isError;\n            else if (filter === 'warn') show = isWarn;\n            issue.style.display = show ? '' : 'none';\n            if (show) visibleCount++;\n          });\n          const headerCountSpan = group.querySelector('.issue-group-header span:last-child');\n          if (headerCountSpan && label) {\n            headerCountSpan.textContent = label + ' (' + visibleCount + ')';\n          }\n        });\n      }\n      function initExportFilters() {\n        const buttons = document.querySelectorAll('.export-filter-btn');\n        if (!buttons.length) return;\n        let current = 'all';\n        buttons.forEach(btn => {\n          btn.addEventListener('click', () => {\n            const val = btn.getAttribute('data-severity') || 'all';\n            current = val;\n            applySeverityFilter(current);\n          });\n        });\n        applySeverityFilter(current);\n      }\n      function initExportUI() {\n        initCollapsibles();\n        initExportFilters();\n      }\n      if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', initExportUI);\n      } else {\n        initExportUI();\n      }\n    })();\n  <\/script>`;
}

module.exports = getReportScript;

